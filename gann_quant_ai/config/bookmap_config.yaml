# ================================================================
# BOOKMAP CONFIGURATION v3.0
# Professional Order Flow & Market Depth Visualization
# ================================================================

version: "3.0.0"

# ────────────────────────────────────────────────────────────────
# HEATMAP – Order book depth visualization over time
# ────────────────────────────────────────────────────────────────
heatmap:
  enabled: true
  bars: 100                    # Number of time bars to display
  levels: 40                   # Price levels per bar
  update_interval_ms: 2000     # Refresh rate
  
  # Color scheme
  color_scheme: "thermal"      # thermal, ocean, plasma, viridis
  color_ranges:
    low_volume:
      threshold: 10
      color: "rgba(0,0,50,0.3)"
    medium_volume:
      threshold: 50
      color: "rgba(0,100,200,0.6)"
    high_volume:
      threshold: 150
      color: "rgba(255,200,0,0.8)"
    whale_volume:
      threshold: 500
      color: "rgba(255,50,50,1.0)"

  # Whale order highlighting
  whale_detection:
    enabled: true
    threshold_multiplier: 3.0    # X times average volume
    highlight_color: "#ff3b3b"
    flash_animation: true

# ────────────────────────────────────────────────────────────────
# DEPTH OF MARKET (DOM) – Level 2 order book
# ────────────────────────────────────────────────────────────────
dom:
  enabled: true
  levels: 20                   # Visible price levels each side
  max_levels: 50               # Maximum levels to fetch
  update_interval_ms: 500

  # Visual settings
  bid_color: "#00d26a"
  ask_color: "#ff3b3b"
  spread_color: "#ffd700"
  volume_bar_opacity: 0.07

  # Stacked volume bars
  show_cumulative: true
  show_order_count: true

# ────────────────────────────────────────────────────────────────
# FOOTPRINT / CLUSTER CHART
# ────────────────────────────────────────────────────────────────
footprint:
  enabled: true
  bars: 30                     # Number of candle bars
  update_interval_ms: 5000
  
  # Cluster settings
  cluster_levels: 20           # Price levels per candle
  
  # Display mode
  mode: "bid_ask"              # bid_ask, delta, total_volume
  
  # Colors
  positive_delta_color: "#00d26a"
  negative_delta_color: "#ff3b3b"
  neutral_color: "#4a5568"
  
  # Imbalance detection
  imbalance:
    enabled: true
    threshold: 3.0             # Buy/Sell ratio > 3:1 = imbalance
    highlight_color: "#ffd700"

# ────────────────────────────────────────────────────────────────
# VOLUME DELTA & CVD
# ────────────────────────────────────────────────────────────────
volume_delta:
  enabled: true
  bars: 60
  update_interval_ms: 3000

  # CVD (Cumulative Volume Delta)
  cvd:
    enabled: true
    show_divergence: true      # Highlight price/CVD divergences
    divergence_threshold: 0.15 # 15% divergence
    line_color: "#00d4ff"
    
  # Delta histogram
  delta_histogram:
    enabled: true
    positive_color: "#00d26a"
    negative_color: "#ff3b3b"

# ────────────────────────────────────────────────────────────────
# TIME & SALES (TAPE)
# ────────────────────────────────────────────────────────────────
tape:
  enabled: true
  max_rows: 50
  update_interval_ms: 500

  # Large trade highlighting
  large_trade:
    enabled: true
    threshold_usd: 50000
    highlight_color: "#ffd700"
    flash_duration_ms: 500

  # Aggressor detection
  show_aggressor: true
  show_trade_value: true

  # Filter options
  min_trade_size: 0.001
  
  # Columns
  columns:
    - "timestamp"
    - "price"
    - "size"
    - "side"
    - "value"

# ────────────────────────────────────────────────────────────────
# ORDER FLOW DETECTION – Iceberg, Spoofing, Stop Runs
# ────────────────────────────────────────────────────────────────
detection:
  enabled: true
  update_interval_ms: 5000

  # Iceberg orders
  iceberg:
    enabled: true
    min_repeat_count: 3        # Same size repeated = iceberg
    confidence_threshold: 0.7
    marker_color: "#00d4ff"

  # Spoofing detection
  spoofing:
    enabled: true
    size_threshold_multiplier: 5.0
    cancel_time_ms: 2000       # If cancelled within this time
    confidence_threshold: 0.6
    marker_color: "#ff9a00"

  # Stop run / hunt detection
  stop_run:
    enabled: true
    wick_ratio_threshold: 0.7  # Long wick = stop hunt
    volume_spike_multiplier: 2.0
    marker_color: "#ff3b3b"

  # Whale tracking
  whale:
    enabled: true
    size_threshold_multiplier: 10.0
    marker_color: "#ffd700"
    show_notification: true

  # Absorption detection
  absorption:
    enabled: true
    volume_absorbed_ratio: 0.8  # Price didn't move despite volume
    confidence_threshold: 0.65
    marker_color: "#9b59b6"

  # Severity levels
  severity_levels:
    - level: "critical"
      color: "#ff3b3b"
      notification: true
    - level: "high"
      color: "#ff9a00"
      notification: true
    - level: "medium"
      color: "#ffd700"
      notification: false
    - level: "low"
      color: "#4a5568"
      notification: false

# ────────────────────────────────────────────────────────────────
# VOLUME BUBBLES – Visual volume representation on chart
# ────────────────────────────────────────────────────────────────
volume_bubbles:
  enabled: true
  min_size_px: 4
  max_size_px: 40
  opacity: 0.6
  
  buy_color: "#00d26a"
  sell_color: "#ff3b3b"
  neutral_color: "#4a5568"

  # Scale
  scale_mode: "relative"      # relative, absolute, log
  reference_period: 20        # bars to average for sizing

# ────────────────────────────────────────────────────────────────
# MULTI-TIMEFRAME – Supported timeframes
# ────────────────────────────────────────────────────────────────
timeframes:
  default: "1m"
  available:
    - code: "1s"
      label: "1 Second"
      seconds: 1
    - code: "5s"
      label: "5 Seconds"
      seconds: 5
    - code: "15s"
      label: "15 Seconds"
      seconds: 15
    - code: "1m"
      label: "1 Minute"
      seconds: 60
    - code: "5m"
      label: "5 Minutes"
      seconds: 300
    - code: "15m"
      label: "15 Minutes"
      seconds: 900
    - code: "1h"
      label: "1 Hour"
      seconds: 3600

# ────────────────────────────────────────────────────────────────
# LAYOUT & RENDERING
# ────────────────────────────────────────────────────────────────
rendering:
  fps_limit: 30
  use_webgl: false
  canvas_antialiasing: true
  crosshair: true
  
  # Grid
  grid:
    enabled: true
    color: "rgba(26,42,58,0.5)"
    line_width: 0.4

  # Price scale
  price_scale:
    position: "right"
    font_size: 9
    color: "#4a5568"

  # Current price line
  current_price_line:
    enabled: true
    color: "#ff9a00"
    style: "dashed"
    label_background: "#ff9a00"
    label_color: "#0a0e17"
