version: 4.0.0
global_mode:
  current_mode: 1
  previous_mode: 3
  last_changed: '2026-02-17T19:47:23.555442'
  changed_by: system
  constraints:
    allow_runtime_switch: true
    require_approval_for_mode_4: true
    max_mode_changes_per_hour: 5
    cooldown_seconds: 30
    auto_revert_on_error: true
    auto_revert_target: 0
  change_reason: Revert test
mode_0_rule_only:
  description: Pure deterministic rule-based trading (Gann + Ehlers)
  engines:
    gann_engine: true
    ehlers_engine: true
    pattern_recognition: true
    ml_engine: false
    ai_agents: false
  signal_generation:
    source: rule_engine
    min_confluence: 2
    confidence_threshold: 0.65
  risk_profile: conservative
  fallback:
    is_fallback_mode: true
    reason: Safest mode - fully deterministic, no ML/AI dependency
mode_1_hybrid:
  description: Rule engine with ML confirmation layer
  engines:
    gann_engine: true
    ehlers_engine: true
    pattern_recognition: true
    ml_engine: true
    ai_agents: false
  signal_generation:
    primary_source: rule_engine
    confirmation_source: ml_engine
    logic: rule_signal AND ml_confirmation
    ml_probability_threshold: 0.6
    min_rule_confidence: 0.55
  risk_profile: moderate
  fallback:
    on_ml_error: revert_to_mode_0
    on_ml_timeout_ms: 5000
    on_ml_low_confidence: use_rule_only
mode_2_ml_dominant:
  description: ML primary signals, Rule as structural filter/guardrail
  engines:
    gann_engine: true
    ehlers_engine: true
    pattern_recognition: true
    ml_engine: true
    ai_agents: false
  signal_generation:
    primary_source: ml_engine
    filter_source: rule_engine
    logic: ml_signal FILTERED_BY rule_structure
    ml_probability_threshold: 0.7
    rule_structural_alignment: true
  guardrails:
    max_ml_disagreement_with_rule: 0.3
    require_trend_alignment: true
    max_consecutive_ml_only_trades: 5
  risk_profile: moderate_aggressive
  fallback:
    on_ml_error: revert_to_mode_0
    on_rule_violation: block_trade
    on_excessive_losses: revert_to_mode_1
mode_3_ai_assisted:
  description: AI agents provide advisory and parameter optimization
  engines:
    gann_engine: true
    ehlers_engine: true
    pattern_recognition: true
    ml_engine: true
    ai_agents: true
  ai_capabilities:
    analyst_agent: true
    regime_agent: true
    optimizer_agent: true
    autonomous_agent: false
  ai_permissions:
    can_override_parameters: true
    can_override_orders: false
    can_suggest_mode_change: true
    can_auto_mode_change: false
  parameter_optimization:
    allowed_parameters:
    - ml_probability_threshold
    - confidence_threshold
    - position_size_multiplier
    - stop_loss_multiplier
    - take_profit_ratio
    max_deviation_from_default: 0.3
    require_backtest_validation: true
    min_backtest_sharpe: 1.2
  risk_profile: moderate
  fallback:
    on_ai_error: revert_to_mode_1
    on_ai_anomaly: revert_to_mode_0
    on_parameter_violation: restore_defaults
mode_4_guarded_autonomous:
  description: AI can propose trades, validated through gate system
  engines:
    gann_engine: true
    ehlers_engine: true
    pattern_recognition: true
    ml_engine: true
    ai_agents: true
  ai_capabilities:
    analyst_agent: true
    regime_agent: true
    optimizer_agent: true
    autonomous_agent: true
  ai_permissions:
    can_propose_trades: true
    can_execute_trades: false
    can_override_parameters: true
    can_suggest_mode_change: true
    broker_access: false
  validation_gate:
    gates:
    - name: risk_engine_validation
      required: true
      weight: 1.0
    - name: exposure_cap_check
      required: true
      max_total_exposure: 0.25
    - name: drawdown_limit_check
      required: true
      max_drawdown: 0.15
    - name: confidence_threshold
      required: true
      min_confidence: 0.75
    - name: rule_alignment_check
      required: true
      min_rule_agreement: 0.5
    - name: cooldown_check
      required: true
      min_interval_minutes: 5
    approval_workflow:
      auto_approve: false
      notification_channels:
      - telegram
      - webhook
      timeout_minutes: 15
  risk_profile: conservative
  fallback:
    on_ai_error: revert_to_mode_0
    on_gate_failure: block_trade_log_event
    on_excessive_proposals: throttle_agent
    max_proposals_per_hour: 10
auto_revert:
  enabled: true
  target_mode: 0
  triggers:
    drawdown_breach:
      enabled: true
      threshold: 0.15
    ml_error_count:
      enabled: true
      max_errors: 3
      window_minutes: 60
    ai_anomaly:
      enabled: true
      detection_methods:
      - confidence_drop
      - prediction_flip
      - drift_detection
    system_health:
      enabled: true
      max_latency_ms: 5000
      max_memory_usage: 0.9
      max_cpu_usage: 0.95
    connectivity:
      enabled: true
      broker_heartbeat_timeout: 30
      data_feed_timeout: 60
transition_log:
  enabled: true
  log_to_file: true
  log_path: logs/mode_transitions.log
  retain_days: 90
  log_fields:
  - timestamp
  - from_mode
  - to_mode
  - trigger
  - triggered_by
  - risk_state_at_transition
  - open_positions_at_transition
